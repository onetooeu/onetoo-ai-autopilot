{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://onetoo.eu/schemas/contrib-submission.v2.schema.json",
  "title": "ONETOO contrib submission v2",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema",
    "submission_id",
    "submitted_at",
    "author",
    "entry",
    "nonce",
    "protocol"
  ],
  "properties": {
    "schema": { "const": "onetoo.contrib-submission.v2" },
    "submission_id": {
      "type": "string",
      "minLength": 8,
      "maxLength": 128
    },
    "submitted_at": { "type": "string", "format": "date-time" },
    "author": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "pubkey", "signature"],
      "properties": {
        "id": { "type": "string", "minLength": 3, "maxLength": 256 },
        "pubkey": { "type": "string", "minLength": 16, "maxLength": 512 },
        "signature": { "type": "string", "minLength": 16, "maxLength": 2048 }
      }
    },
    "entry": {
      "type": "object",
      "additionalProperties": false,
      "required": ["title", "url", "description", "categories", "canonical"],
      "properties": {
        "title": { "type": "string", "minLength": 2, "maxLength": 140 },
        "url": { "type": "string", "format": "uri" },
        "description": { "type": "string", "minLength": 10, "maxLength": 500 },
        "categories": {
          "type": "array",
          "minItems": 1,
          "maxItems": 12,
          "items": { "type": "string", "minLength": 2, "maxLength": 48 }
        },
        "canonical": {
          "type": "object",
          "additionalProperties": false,
          "required": ["url", "lang"],
          "properties": {
            "url": { "type": "string", "format": "uri" },
            "lang": { "type": "string", "minLength": 2, "maxLength": 16 }
          }
        }
      }
    },
    "client": {
      "type": "object",
      "additionalProperties": false,
      "required": ["ip_hash", "ua_hash"],
      "properties": {
        "ip_hash": { "type": "string", "minLength": 8, "maxLength": 128 },
        "ua_hash": { "type": "string", "minLength": 8, "maxLength": 128 }
      }
    },
    "nonce": { "type": "string", "minLength": 8, "maxLength": 256 },
    "protocol": {
      "type": "object",
      "additionalProperties": false,
      "required": ["version", "replay_window_sec"],
      "properties": {
        "version": { "type": "string", "minLength": 2, "maxLength": 64 },
        "replay_window_sec": { "type": "integer", "minimum": 60, "maximum": 3600 }
      }
    }
  }
}
